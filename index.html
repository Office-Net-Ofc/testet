<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Confirma√ß√£o de Presen√ßa - Pedro D√¥mini</title>

<style>
body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #f7f2e8;
    min-height: 100vh;
    margin: 0;
    overflow-x: hidden;
}

.folhas {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

.folha {
    position: absolute;
    width: 28px;
    opacity: 0.6;
    animation: cair linear infinite;
}

@keyframes cair {
    from { transform: translateY(-50px) rotate(0deg); }
    to { transform: translateY(110vh) rotate(360deg); }
}

.container {
    position: relative;
    z-index: 2;
    background: #ffffff;
    padding: 30px;
    border-radius: 18px;
    max-width: 440px;
    margin: 40px auto;
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
    border: 4px solid #2f7d32;
}

.header-img {
    width: 100%;
    max-width: 340px;
    display: block;
    margin: 0 auto 20px;
}

h2 {
    text-align: center;
    color: #2f7d32;
}

label {
    font-weight: 600;
    margin-top: 18px;
    display: block;
    color: #4e342e;
}

input, textarea, select {
    width: 100%;
    padding: 12px;
    margin-top: 6px;
    border-radius: 8px;
    border: 1px solid #cfcfcf;
    font-size: 15px;
}

textarea {
    resize: vertical;
}

button {
    margin-top: 25px;
    width: 100%;
    padding: 15px;
    background-color: #2f7d32;
    color: white;
    font-size: 17px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
}

button:hover {
    background-color: #256428;
}

/* LOADING */
#loading {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(255,255,255,0.96);
    z-index: 9999;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 20px;
}
</style>
</head>

<body>

<!-- LOADING -->
<div id="loading">
    <h2 id="loadingTitle">‚è≥ Aguarde</h2>
    <p id="loadingText">Estamos registrando seus dados üíö</p>
</div>

<div class="folhas" id="folhas"></div>

<div class="container">

<img
  src="https://office-net-ofc.github.io/confirmacao-de-presenca/imagens/aergergerg.PNG"
  class="header-img"
  alt="Convite Pedro D√¥mini">

<h2>üåø Confirma√ß√£o de Presen√ßa</h2>

<label>Qual √© o seu nome?</label>
<input type="text" id="nome" placeholder="Digite seu nome completo">

<label>Quantas pessoas contando com voc√™ ir√£o?</label>
<select id="quantidade">
    <option value="">Qtd</option>
    <option>1</option><option>2</option><option>3</option>
    <option>4</option><option>5</option><option>6</option>
    <option>7</option><option>8</option><option>9</option>
    <option>10</option>
</select>

<label>Digite o nome das pessoas que ir√£o com voc√™:</label>
<textarea id="pessoas" rows="4"
placeholder="Ex: Maria Silva, Jo√£o Silva (5 anos)"></textarea>

<label>Confirma presen√ßa?</label>
<select id="status">
    <option value="Confirmado">‚úÖ Sim, estaremos presentes</option>
    <option value="N√£o poder√° comparecer">‚ùå N√£o poderemos comparecer</option>
</select>

<button onclick="enviar()">Enviar confirma√ß√£o üíö</button>

</div>

<script>
// ELEMENTOS
const nomeEl = document.getElementById("nome");
const quantidadeEl = document.getElementById("quantidade");
const pessoasEl = document.getElementById("pessoas");
const statusEl = document.getElementById("status");
const loading = document.getElementById("loading");
const loadingTitle = document.getElementById("loadingTitle");
const loadingText = document.getElementById("loadingText");

// FOLHAS ANIMADAS
const folhasContainer = document.getElementById("folhas");
const folhaImg =
"https://office-net-ofc.github.io/confirmacao-de-presenca/imagens/Moldes_De_Folhas_Para_Imprimir_-_Dicas_Pr%C3%A1ticas__ABB-removebg-preview.png";

for (let i = 0; i < 20; i++) {
    const folha = document.createElement("img");
    folha.src = folhaImg;
    folha.className = "folha";
    folha.style.left = Math.random() * 100 + "vw";
    folha.style.animationDuration = (8 + Math.random() * 6) + "s";
    folha.style.animationDelay = Math.random() * 5 + "s";
    folhasContainer.appendChild(folha);
}

// ENVIO
function enviar() {
    if (!nomeEl.value || !quantidadeEl.value) {
        alert("Preencha nome e quantidade üòä");
        return;
    }

    loading.style.display = "flex";
    loadingTitle.innerText = "‚è≥ Aguarde";
    loadingText.innerText = "Estamos registrando seus dados üíö";

    const formData = new FormData();
    formData.append("nome", nomeEl.value);
    formData.append("quantidade", quantidadeEl.value);
    formData.append("pessoas", pessoasEl.value);
    formData.append("status", statusEl.value);

    fetch("https://script.google.com/macros/s/AKfycbww_YbB_cwj4VSDiK6EIqsp0dSEfp-unUaG6EIXls-znKxZ3rO2nAiSIsTUZLqfQ-HI/exec", {
        method: "POST",
        body: formData
    })
    .then(res => res.json())
    .then(resp => {

        if (resp.status === "OK") {
            loadingTitle.innerText = "‚úÖ Confirma√ß√£o enviada!";
            loadingText.innerText =
              "Os dados foram registrados e o organizador foi avisado por e-mail üíö";

            setTimeout(() => {
                loading.style.display = "none";
            }, 4000);

            // Limpa formul√°rio
            nomeEl.value = "";
            quantidadeEl.value = "";
            pessoasEl.value = "";
            statusEl.value = "Confirmado";

        } else if (resp.status === "ERRO") {
            loadingTitle.innerText = "‚ùå Erro";
            loadingText.innerText =
              resp.mensagem || "Erro ao registrar confirma√ß√£o.";

        } else {
            throw new Error("Resposta inesperada");
        }
    })
    .catch(err => {
        console.error(err);
        loadingTitle.innerText = "‚ùå Erro";
        loadingText.innerText =
          "N√£o foi poss√≠vel registrar sua confirma√ß√£o. Tente novamente.";
    });
}
</script>

</body>
</html>
